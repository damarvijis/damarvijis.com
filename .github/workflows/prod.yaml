# name: Deploy to production
# on:
#   push:
#     tags:
#       - v*
#   workflow_dispatch: {}
# jobs:
#   deploy:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v3
#       - uses: actions/setup-node@v3
#         with:
#           node-version: "18"
#       - run: npm ci --force
#       - run: printf "${{ secrets.PROD_ENV }}" >> .env
#       - uses: shimataro/ssh-key-action@v2
#         with:
#           key: ${{ secrets.DEPLOY_KEY }}
#           known_hosts: unnecessary
#           config: |
#             StrictHostKeyChecking no
#       - run: rsync ubuntu@api.dev.karirlab.co:/opt/caddy/www/karirlab-open-api/api.json api.json
#       - run: API_CONTRACT_SOURCE=./api.json npm run build
#       - run: rsync -lpr --delete --exclude .git ./ ubuntu@ap-southeast-1-prd-fe-01.karirlab.co:/app/karirlab.co/
#       - run: ssh ubuntu@ap-southeast-1-prd-fe-01.karirlab.co "source /home/ubuntu/.nvm/nvm.sh && cd /app/karirlab.co && node ./node_modules/puppeteer/install.js && pm2 restart karirlab-frontend || pm2 start --name karirlab-frontend npm -- run start"
